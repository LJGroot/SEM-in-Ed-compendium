# Analysis of categorical outcomes {#ch27}

Until now we have focused on the analysis of continuous outcomes (endogenous variables in path models, indicators in factor models), and we have used the maximum likelihood (ML) estimator that assumes that the distribution of the scores on the observed variables are multivariate normal. Various robust estimators can be used when the assumption of multivariate normality cannot be met, which adjust the $χ^2$ test statistic and $SE$s for nonnormality, but those robust estimators still assume the data are continuous. When we want to analyse categorical data, adjusting for nonnormality is not sufficient because the parameters are not interpretable if the model does not take into account the categorical nature of the observed variables it is trying to explain.

The chapters on [multiple groups](#ch22) and [single-indicator constructs](#ch20) introduced how to incorporate categorical predictors into a SEM. In this chapter we will focus on how we can analyse categorical outcomes. When we have categorical data instead of continuous data, the responses are limited to a small number of values (e.g., 2, 3, or 4 response categories). To be able to analyse these responses, we assume that the categorical responses are representations of a continuous underlying variable, often called a "latent response" variable (distinct from a latent common factor). A latent response is a variable we would like to have measured (e.g., how happy you are) using a more sensitive instrument, but in practice we were only capable of measuring whether someone is in a particular range (e.g., whether they feel happy *never*, *rarely*, *often*, or *always*). The idea is that people with lower scores on the latent response are likely to indicate lower categories of the observed categorical response, whereas people with higher scores on the latent response are likely to indicate higher categories of the observed categorical response. We can think of each latent response as being a single-indicator construct, where the single indicator is the observed categorical response.

Figure \@ref(fig:fig27-1) shows the relation between the underlying continuous variable ($\mathrm{y}^{*}$) and the observed categorical response ($\mathrm{y}$) for a dichotomous variable. Let's consider this to be a test question, which is a common situation with binary indicators. In this example, the latent response variable $\mathrm{y}^{*}$ could be labelled "how well [they] understand this test question" or their "propensity for solving this problem", and the observed binary response would simply be correct (1) or incorrect (0). Here, the difference between the answer "0" and "1" is determined by the threshold ($δ_1$), which represents "how well [they] need to understand this test question in order to get it correct". When an individual's unobserved $\mathrm{y}^{*}$ is below the threshold, we assume that the observed categorical response would be "0" (i.e., they do not understand well enough to get the question correct), whereas a latent response above the threshold would result in an observed response of "1" (i.e., they do understand well enough to get the question correct). When we assume this underlying variable follows a standard normal distribution (i.e., with $μ = 0$ and $σ = 1$), then the position of the threshold is the value of the standard normal distribution ($z$ score) that makes the area under the curve lower than (to the left of) the threshold equal to the proportion of observed responses of '0' (i.e., what percentage got the question incorrect).

```{r label="fig27-1", echo = FALSE, out.width = "80%", fig.align = "center", fig.cap="A dichotomous response ($y$) and associated theshold ($δ_1$) for an underlying continuous variable $y^{*}$"}

knitr::include_graphics("images/Ch27-1.png")
```

The information above applies to the situation when we have two response categories (dichotomous/binary data), but can easily be extended to multiple ordered response categories (polytomous/ordinal data). Additional thresholds define the classification of the observed categorical responses, where the number of thresholds ($c$) is equal the number of categories ($C$) minus one ($c = C − 1$). An example of a variable with three response categories is given in Figure \@ref(fig:fig27-2). 

```{r label="fig27-2", echo = FALSE, out.width = "80%", fig.align = "center", fig.cap="The estimation of thresholds ($δ_1$ and $δ_2$): Observed categorical responses y are representations of underlying continuous scores $y^*$. There are 20%, 45%, and 35% observed responses in categories 0, 1, and 2 respectively. Cumulatively this is 20%, 65% (20 + 45), and 100% (20 + 45 + 35) of the entire distribution. The first threshold is located where the area under the curve to the left of the threshold is 20% (%δ_1 = Z_{20%} = −0.842). The second threshold is located where the area under the curve to the left of the threshold is 65% (%δ_2 = Z_{65%} = 0.385)." }

knitr::include_graphics("images/Ch27-2.png")
```
